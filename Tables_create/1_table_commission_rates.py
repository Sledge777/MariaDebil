import mysql.connector
from datetime import datetime

#--------------------------------------
def create_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="Ms_phone_fox62052!",
        database="ms_phone"
    )
#--------------------------------------

def create_commission_rates():
    conn = create_connection()
    cursor = conn.cursor()

    # Удаляем таблицу commission_rates, если она уже существует
    cursor.execute("DROP TABLE IF EXISTS commission_rates;")
    
    # Создаем таблицу commission_rates
    cursor.execute("""
    CREATE TABLE IF NOT EXISTS commission_rates (
        goods_price_group VARCHAR(255) PRIMARY KEY,
        category VARCHAR(255),
        commission_percent DECIMAL(5, 2)
    );
    """)
    # Данные для вставки в таблицу commission_rates
    commission_data = [
    # Сим карты
    ('050_Х1.5_С', 'Сим карты', 100.0),
    ('050_Х1.2_С', 'Сим карты', 100.0),
    ('050_Х1.0_С', 'Сим карты', 100.0),
    ('050_Х0.5_С', 'Сим карты', 100.0),
    ('040_Х1.0_С', 'Сим карты', 100.0),
    ('030_Х1.0_С', 'Сим карты', 100.0),
    ('050_Х2.0_С', 'Сим карты', 100.0),

    # Подарки
    ('005_Х1.0_П', 'Подарки', 5.0),
    ('002_Х1.0_П', 'Подарки', 2.0),
    ('002_Х2.0_П', 'Подарки', 4.0),
    ('001_Х1.0_П', 'Подарки', 1.0),
    ('002_Х4.0_П', 'Подарки', 8.0),

   


    # Настройки
    ('010_Х3.0_Н', 'Настройки', 30.0),
    ('010_Х2.5_Н', 'Настройки', 25.0),
    ('010_Х2.0_Н', 'Настройки', 20.0),
    ('010_Х1.5_Н', 'Настройки', 15.0),
    ('010_Х1.0_Н', 'Настройки', 10.0),


    # Страховки
    ('010_Х1.5_У', 'Страховки', 15.0),
    ('010_Х1.2_У', 'Страховки', 12.0),
    ('010_Х1.0_У', 'Страховки', 10.0),
    ('010_Х0.5_У', 'Страховки', 5.0),
    ('010_Х2.0_У', 'Страховки', 20.0),
    ('010_Х2.5_У', 'Страховки', 25.0),
    ('010_Х3.0_У', 'Страховки', 30.0),

    # Аксессуары
    ('030_Х1.0_А', 'Аксессуары', 30.0),
    ('010_X2.0_А', 'Аксессуары', 20.0),
    ('005_Х2.0_А', 'Аксессуары', 10.0),
    ('005_Х1.5_А', 'Аксессуары', 7.5),
    ('005_Х1.2_А', 'Аксессуары', 6.0),
    ('005_Х1.0_А', 'Аксессуары', 5.0),
    ('005_Х0.5_А', 'Аксессуары', 2.5),
    ('002_Х4.0_А', 'Аксессуары', 8.0),
    ('030_Х1.5_А', 'Аксессуары', 45.0),
    ('030_Х2.0_А', 'Аксессуары', 60.0),
    ('002_Х2.0_А', 'Аксессуары', 4.0),
    ('002_Х1.0_А', 'Аксессуары', 2.0),
    ('001_Х1.0_А', 'Аксессуары', 1.0),
    ('002_Х0.5_А_Акция', 'Аксессуары', 1.0),
    ('002_Х1.0_А_Акция', 'Аксессуары', 2.0),
    ('002_Х1.5_А_Акция', 'Аксессуары', 3.0),
    ('002_Х2.0_А_Акция', 'Аксессуары', 4.0),
    ('002_Х2.5_А_Акция', 'Аксессуары', 5.0),
    ('002_Х3.0_А_Акция', 'Аксессуары', 6.0),
    ('002_Х3.5_А_Акция', 'Аксессуары', 7.0),
    ('002_Х4.0_А_Акция', 'Аксессуары', 8.0),
    ('002_Х0.5_А', 'Аксессуары', 1.0),
    ('002_Х1.5_А', 'Аксессуары', 3.0),
    ('002_Х2.5_А', 'Аксессуары', 5.0),
    ('002_Х3.0_А', 'Аксессуары', 6.0),
    ('002_Х3.5_А', 'Аксессуары', 7.0),

    # MS.Home
    ('030_Х1.0_Д', 'MS.Home', 30.0),
    ('010_X2.0_Д', 'MS.Home', 20.0),
    ('005_Х2.0_Д', 'MS.Home', 10.0),
    ('005_Х1.5_Д', 'MS.Home', 7.5),
    ('005_Х1.2_Д', 'MS.Home', 6.0),
    ('005_Х1.0_Д', 'MS.Home', 5.0),
    ('005_Х0.5_Д', 'MS.Home', 2.5),
    ('002_Х4.0_Д', 'MS.Home', 8.0),
    ('030_Х1.5_Д', 'MS.Home', 45.0),
    ('030_Х2.0_Д', 'MS.Home', 60.0),
    ('002_Х2.0_Д', 'MS.Home', 4.0),
    ('002_Х1.0_Д', 'MS.Home', 2.0),
    ('001_Х1.0_Д', 'MS.Home', 1.0),
    ('002_Х0.5_Д_Акция', 'MS.Home', 1.0),
    ('002_Х1.0_Д_Акция', 'MS.Home', 2.0),
    ('002_Х1.5_Д_Акция', 'MS.Home', 3.0),
    ('002_Х2.0_Д_Акция', 'MS.Home', 4.0),
    ('002_Х2.5_Д_Акция', 'MS.Home', 5.0),
    ('002_Х3.0_Д_Акция', 'MS.Home', 6.0),
    ('002_Х3.5_Д_Акция', 'MS.Home', 7.0),
    ('002_Х4.0_Д_Акция', 'MS.Home', 8.0),
    ('002_Х0.5_Д', 'MS.Home', 1.0),
    ('002_Х1.5_Д', 'MS.Home', 3.0),
    ('002_Х2.5_Д', 'MS.Home', 5.0),
    ('002_Х3.0_Д', 'MS.Home', 6.0),
    ('002_Х3.5_Д', 'MS.Home', 7.0),

    # LifeStyle
    ('002_Х4.0_LS', 'LifeStyle', 8.0),
    ('002_Х2.0_LS', 'LifeStyle', 4.0),
    ('002_Х1.5_LS', 'LifeStyle', 3.0),
    ('002_Х1.2_LS', 'LifeStyle', 2.4),
    ('002_Х1.0_LS', 'LifeStyle', 2.0),
    ('002_Х0.5_LS', 'LifeStyle', 1.0),
    ('001_Х2.0_LS', 'LifeStyle', 2.0),
    ('001_Х1.5_LS', 'LifeStyle', 1.5),
    ('001_Х1.2_LS', 'LifeStyle', 1.2),
    ('001_Х1.0_LS', 'LifeStyle', 1.0),
    ('001_Х0.5_LS', 'LifeStyle', 0.5),
    ('003_Х2.0_LS', 'LifeStyle', 6.0),
    ('005_Х2.0_LS', 'LifeStyle', 10.0),
    ('002_Х2.5_LS', 'LifeStyle', 5.0),
    ('002_Х0.5_LS_Акция', 'LifeStyle', 1.0),
    ('002_Х1.0_LS_Акция', 'LifeStyle', 2.0),
    ('002_Х1.5_LS_Акция', 'LifeStyle', 3.0),
    ('002_Х2.0_LS_Акция', 'LifeStyle', 4.0),
    ('002_Х2.5_LS_Акция', 'LifeStyle', 5.0),

    # На связи
    ('002_Х4.0_Э', 'На связи', 6.0),
    ('002_Х2.0_Э', 'На связи', 4.0),
    ('002_Х1.5_Э', 'На связи', 3.0),
    ('002_Х1.2_Э', 'На связи', 2.4),
    ('002_Х1.0_Э', 'На связи', 2.0),
    ('002_Х0.5_Э', 'На связи', 1.0),
    ('001_Х2.0_Э', 'На связи', 2.0),
    ('001_Х1.5_Э', 'На связи', 1.5),
    ('001_Х1.2_Э', 'На связи', 1.2),
    ('001_Х1.0_Э', 'На связи', 1.0),
    ('001_Х0.5_Э', 'На связи', 0.5),
    ('002_Х0.5_Э_Акция', 'На связи', 1.0),
    ('002_Х1.0_Э_Акция', 'На связи', 2.0),
    ('002_Х1.5_Э_Акция', 'На связи', 3.0),
    ('002_Х2.0_Э_Акция', 'На связи', 4.0),
    ('002_Х2.5_Э_Акция', 'На связи', 5.0),

    # ТВ
    ('002_Х4.0_ТВ', 'ТВ', 8.0),
    ('002_Х2.0_ТВ', 'ТВ', 4.0),
    ('002_Х1.5_ТВ', 'ТВ', 3.0),
    ('002_Х1.2_ТВ', 'ТВ', 2.4),
    ('002_Х1.0_ТВ', 'ТВ', 2.0),
    ('002_Х0.5_ТВ', 'ТВ', 1.0),
    ('001_Х2.0_ТВ', 'ТВ', 2.0),
    ('001_Х1.5_ТВ', 'ТВ', 1.5),
    ('001_Х1.2_ТВ', 'ТВ', 1.2),
    ('001_Х1.0_ТВ', 'ТВ', 1.0),
    ('001_Х0.5_ТВ', 'ТВ', 0.5),
    ('002_Х0.5_ТВ_Акция', 'ТВ', 1.0),
    ('002_Х1.0_ТВ_Акция', 'ТВ', 2.0),
    ('002_Х1.5_ТВ_Акция', 'ТВ', 3.0),
    ('002_Х2.0_ТВ_Акция', 'ТВ', 4.0),
    ('002_Х2.5_ТВ_Акция', 'ТВ', 5.0),
]

# Далее используешь cursor.executemany(...) как у тебя уже написано.


    # Вставляем данные в таблицу
    cursor.executemany("""
        INSERT INTO commission_rates (goods_price_group, category, commission_percent)
        VALUES (%s, %s, %s)
    """, commission_data)

    conn.commit()
    
    #----------------------------------------------------------------------------------
    commit_time = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    print("✅ Данные успешно загружены в MariaDB.")
    print(f"Загружено записей: {len(commission_data)}")
    print(f"Запись в таблицу commission_rates выполнена в: {commit_time}")
    #----------------------------------------------------------------------------------
    cursor.close()
    conn.close()

if __name__ == "__main__":
    create_commission_rates()
